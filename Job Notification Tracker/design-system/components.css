/**
 * KodNest Premium Build System
 * Component Library — v1.0
 *
 * Contains every reusable UI component in the system.
 * Each component is self-contained. No component imports another.
 * Variants are modifier classes on the base: .btn--primary, .card--flat, etc.
 *
 * Components in this file:
 *   1.  Buttons
 *   2.  Badges / Status Indicators
 *   3.  Cards
 *   4.  Inputs & Form Fields
 *   5.  Prompt Box
 *   6.  Progress Indicator
 *   7.  Step Task Checklist
 *   8.  Proof Checklist Items
 *   9.  Divider with label
 *   10. Inline Alert / Notification
 *   11. Tag
 *   12. Tooltip (CSS-only)
 *
 * Depends on: tokens.css, base.css
 */


/* ═══════════════════════════════════════════════════════
   1. BUTTONS
   Primary · Secondary · Ghost · Danger
   Sizes: default · sm · lg
   Width: default (inline) · block (full-width)
═══════════════════════════════════════════════════════ */

.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-1);
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  letter-spacing: var(--tracking-wide);
  line-height: 1;
  text-decoration: none;
  white-space: nowrap;
  vertical-align: middle;
  user-select: none;

  /* Geometry */
  padding: var(--space-1) var(--space-2);       /* 8px 16px */
  border-radius: var(--radius-md);
  border: 1.5px solid transparent;

  /* Motion */
  transition:
    background-color var(--transition-fast),
    border-color var(--transition-fast),
    color var(--transition-fast),
    opacity var(--transition-fast);

  /* Override for <a> tags used as buttons */
  cursor: pointer;
}

.btn:disabled,
.btn[aria-disabled="true"] {
  opacity: 0.45;
  cursor: not-allowed;
  pointer-events: none;
}

/* — Primary: Solid accent fill — */
.btn--primary {
  background-color: var(--color-accent);
  border-color: var(--color-accent);
  color: var(--color-text-inverse);
}

.btn--primary:hover {
  background-color: var(--color-accent-dark);
  border-color: var(--color-accent-dark);
}

.btn--primary:active {
  background-color: var(--color-accent-dark);
  transform: translateY(1px);
}

/* — Secondary: Outlined accent — */
.btn--secondary {
  background-color: transparent;
  border-color: var(--color-accent);
  color: var(--color-accent);
}

.btn--secondary:hover {
  background-color: var(--color-accent-subtle);
}

.btn--secondary:active {
  background-color: var(--color-accent-subtle);
  transform: translateY(1px);
}

/* — Ghost: Minimal, no border — */
.btn--ghost {
  background-color: transparent;
  border-color: transparent;
  color: var(--color-text-secondary);
}

.btn--ghost:hover {
  background-color: var(--color-surface-subtle);
  color: var(--color-text-primary);
}

/* — Neutral: Bordered neutral — */
.btn--neutral {
  background-color: var(--color-surface);
  border-color: var(--color-border);
  color: var(--color-text-primary);
}

.btn--neutral:hover {
  border-color: var(--color-border-strong);
  background-color: var(--color-surface-subtle);
}

/* — Danger: Destructive actions — */
.btn--danger {
  background-color: transparent;
  border-color: var(--color-error);
  color: var(--color-error);
}

.btn--danger:hover {
  background-color: var(--color-error-bg);
}

/* — Sizes — */
.btn--sm {
  font-size: var(--text-xs);
  padding: var(--space-half) var(--space-1);   /* 4px 8px */
  letter-spacing: var(--tracking-wide);
}

.btn--lg {
  font-size: var(--text-base);
  padding: var(--space-2) var(--space-3);       /* 16px 24px */
  letter-spacing: var(--tracking-normal);
}

/* — Full width — */
.btn--block {
  width: 100%;
}


/* ═══════════════════════════════════════════════════════
   2. BADGES / STATUS INDICATORS
   Small, inline status labels. Non-interactive.
   Used in: Top Bar status, step states, tags.
═══════════════════════════════════════════════════════ */

.badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-half);
  font-family: var(--font-sans);
  font-size: var(--text-xs);
  font-weight: var(--weight-semibold);
  letter-spacing: var(--tracking-wide);
  line-height: 1;
  padding: var(--space-half) var(--space-1);   /* 4px 8px */
  border-radius: var(--radius-full);
  border: 1px solid transparent;
  white-space: nowrap;
}

/* Dot indicator prefix */
.badge::before {
  content: '';
  display: block;
  width: 6px;
  height: 6px;
  border-radius: var(--radius-full);
  flex-shrink: 0;
}

.badge--not-started {
  background-color: var(--color-surface-subtle);
  border-color: var(--color-border);
  color: var(--color-text-muted);
}

.badge--not-started::before {
  background-color: var(--color-border-strong);
}

.badge--in-progress {
  background-color: var(--color-warning-bg);
  border-color: var(--color-warning-border);
  color: var(--color-warning);
}

.badge--in-progress::before {
  background-color: var(--color-warning);
}

.badge--shipped,
.badge--success {
  background-color: var(--color-success-bg);
  border-color: var(--color-success-border);
  color: var(--color-success);
}

.badge--shipped::before,
.badge--success::before {
  background-color: var(--color-success);
}

.badge--error {
  background-color: var(--color-error-bg);
  border-color: var(--color-error-border);
  color: var(--color-error);
}

.badge--error::before {
  background-color: var(--color-error);
}

.badge--neutral {
  background-color: var(--color-surface-subtle);
  border-color: var(--color-border);
  color: var(--color-text-secondary);
}

.badge--neutral::before {
  background-color: var(--color-text-muted);
}


/* ═══════════════════════════════════════════════════════
   3. CARDS
   Primary content container. Subtle border, no shadow.
   Content inside cards follows the same token rules.
═══════════════════════════════════════════════════════ */

.card {
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

/* — Card sections — */
.card__header {
  padding: var(--space-3);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

.card__header h4,
.card__header h5 {
  margin: 0;
}

.card__body {
  padding: var(--space-3);
}

.card__body > * + * {
  margin-top: var(--space-2);
}

.card__footer {
  padding: var(--space-2) var(--space-3);
  border-top: 1px solid var(--color-border);
  background-color: var(--color-surface-subtle);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-2);
}

/* — Variants — */
.card--flat {
  background-color: var(--color-surface-subtle);
  border-color: var(--color-border);
}

.card--dashed {
  background-color: transparent;
  border: 1.5px dashed var(--color-border-strong);
}

.card--accent {
  border-color: var(--color-accent);
  border-left-width: 3px;
}

.card--success {
  border-color: var(--color-success-border);
  border-left-width: 3px;
}

.card--warning {
  border-color: var(--color-warning-border);
  border-left-width: 3px;
}

.card--error {
  border-color: var(--color-error-border);
  border-left-width: 3px;
}


/* ═══════════════════════════════════════════════════════
   4. INPUTS & FORM FIELDS
   Clean borders. Clear focus. No heavy shadows.
   Labels always visible. Hints below the input.
═══════════════════════════════════════════════════════ */

/* Field wrapper */
.field {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.field + .field {
  margin-top: var(--space-3);
}

/* Label */
.field__label {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-primary);
  line-height: var(--leading-snug);
}

.field__label.required::after {
  content: ' *';
  color: var(--color-accent);
}

/* Shared input base */
.input,
.textarea,
.select {
  width: 100%;
  font-family: var(--font-sans);
  font-size: var(--text-base);
  font-weight: var(--weight-regular);
  color: var(--color-text-primary);
  background-color: var(--color-surface);
  border: 1.5px solid var(--color-border);
  border-radius: var(--radius-md);
  padding: var(--space-1) var(--space-2);       /* 8px 16px */
  line-height: var(--leading-normal);
  appearance: none;
  transition:
    border-color var(--transition-fast),
    box-shadow var(--transition-fast);
}

.input::placeholder,
.textarea::placeholder {
  color: var(--color-text-muted);
}

.input:hover,
.textarea:hover,
.select:hover {
  border-color: var(--color-border-strong);
}

.input:focus,
.textarea:focus,
.select:focus {
  outline: none;
  border-color: var(--color-border-focus);
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--color-accent) 12%, transparent);
}

/* Textarea */
.textarea {
  resize: vertical;
  min-height: 96px;
  line-height: var(--leading-relaxed);
}

/* Select */
.select {
  cursor: pointer;
  padding-right: var(--space-5);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2357534E' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right var(--space-1) center;   /* REQ3: 8px on-scale replaces 12px */
}

/* Hint text */
.field__hint {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  line-height: var(--leading-normal);
}

/* Error state on field */
.field--error .input,
.field--error .textarea,
.field--error .select {
  border-color: var(--color-error-border);
}

.field--error .input:focus,
.field--error .textarea:focus {
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--color-error) 10%, transparent);
}

.field__error-message {
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  color: var(--color-error);
  line-height: var(--leading-normal);
}

/* Disabled */
.input:disabled,
.textarea:disabled,
.select:disabled {
  background-color: var(--color-surface-subtle);
  color: var(--color-text-muted);
  cursor: not-allowed;
  border-color: var(--color-border);
}

/* Checkbox & Radio */
.checkbox-field,
.radio-field {
  display: flex;
  align-items: flex-start;
  gap: var(--space-1);
  cursor: pointer;
}

.checkbox-field input[type="checkbox"],
.radio-field input[type="radio"] {
  width: 16px;
  height: 16px;
  min-width: 16px;
  border: 1.5px solid var(--color-border-strong);
  border-radius: var(--radius-sm);
  appearance: none;
  background-color: var(--color-surface);
  cursor: pointer;
  margin-top: 2px;
  transition:
    background-color var(--transition-fast),
    border-color var(--transition-fast);
}

.radio-field input[type="radio"] {
  border-radius: var(--radius-full);
}

.checkbox-field input[type="checkbox"]:checked {
  background-color: var(--color-accent);
  border-color: var(--color-accent);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10'%3E%3Cpath fill='none' stroke='%23ffffff' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' d='M2 5l2.5 2.5L8 3'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
}

.radio-field input[type="radio"]:checked {
  border-color: var(--color-accent);
  box-shadow: inset 0 0 0 3px var(--color-accent);
}

.checkbox-label,
.radio-label {
  font-size: var(--text-sm);
  color: var(--color-text-primary);
  line-height: var(--leading-normal);
  cursor: pointer;
}


/* ═══════════════════════════════════════════════════════
   5. PROMPT BOX
   Displays a copyable AI prompt or code snippet.
   Secondary panel component.
═══════════════════════════════════════════════════════ */

.prompt-box {
  background-color: var(--color-surface-subtle);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  overflow: hidden;
}

.prompt-box__content {
  padding: var(--space-2) var(--space-3);
  font-family: var(--font-mono);
  font-size: var(--text-sm);
  color: var(--color-text-primary);
  line-height: var(--leading-relaxed);
  background: none;
  border: none;
  white-space: pre-wrap;
  word-break: break-word;
  max-height: 200px;
  overflow-y: auto;
}

.prompt-box__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-half) var(--space-2);
  border-top: 1px solid var(--color-border);
  background-color: var(--color-surface);
}

.prompt-box__meta {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  font-family: var(--font-mono);
}

/* Copied state */
.prompt-box.is-copied .prompt-box__footer {
  background-color: var(--color-success-bg);
}


/* ═══════════════════════════════════════════════════════
   6. PROGRESS INDICATOR (Step X / Y)
   Top bar center component. Communicates position in flow.
═══════════════════════════════════════════════════════ */

.progress-indicator {
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.progress-indicator__label {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-secondary);
  white-space: nowrap;
  letter-spacing: var(--tracking-normal);
}

.progress-indicator__label span {
  color: var(--color-text-primary);
  font-weight: var(--weight-semibold);
}

.progress-indicator__track {
  width: 120px;
  height: 3px;
  background-color: var(--color-border);
  border-radius: var(--radius-full);
  overflow: hidden;
  flex-shrink: 0;
}

.progress-indicator__fill {
  height: 100%;
  background-color: var(--color-accent);
  border-radius: var(--radius-full);
  transition: width var(--transition-slow);
}


/* ═══════════════════════════════════════════════════════
   7. STEP TASK CHECKLIST (Primary workspace)
   Shows what is done, active, and upcoming in a step.
═══════════════════════════════════════════════════════ */

.task-list {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.task-item {
  display: flex;
  align-items: flex-start;
  gap: var(--space-2);
  padding: var(--space-1) 0;
  border-bottom: 1px solid var(--color-border);
}

.task-item:last-child {
  border-bottom: none;
}

.task-item__icon {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: var(--radius-full);
  font-size: 10px;
  line-height: 1;
  font-weight: var(--weight-bold);
  margin-top: 1px;
}

.task-item__text {
  font-size: var(--text-sm);
  line-height: var(--leading-normal);
  flex: 1;
}

/* States */
.task-item--done .task-item__icon {
  background-color: var(--color-success-bg);
  color: var(--color-success);
  border: 1px solid var(--color-success-border);
}

.task-item--done .task-item__text {
  color: var(--color-text-muted);
  text-decoration: line-through;
  text-decoration-color: var(--color-border-strong);
}

.task-item--active .task-item__icon {
  background-color: var(--color-accent-subtle);
  color: var(--color-accent);
  border: 1px solid var(--color-error-border);
}

.task-item--active .task-item__text {
  color: var(--color-text-primary);
  font-weight: var(--weight-medium);
}

.task-item--pending .task-item__icon {
  background-color: var(--color-surface-subtle);
  color: var(--color-text-muted);
  border: 1px solid var(--color-border);
}

.task-item--pending .task-item__text {
  color: var(--color-text-muted);
}


/* ═══════════════════════════════════════════════════════
   8. PROOF CHECKLIST ITEMS (Proof Footer)
   Larger checkboxes with label and optional proof input.
═══════════════════════════════════════════════════════ */

.proof-items {
  display: flex;
  align-items: stretch;
  gap: 0;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-lg);
  overflow: hidden;
  background-color: var(--color-surface);
}

.proof-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
  padding: var(--space-2) var(--space-3);
  border-right: 1px solid var(--color-border);
  transition: background-color var(--transition-fast);
}

.proof-item:last-child {
  border-right: none;
}

.proof-item__check {
  display: flex;
  align-items: center;
  gap: var(--space-1);
  cursor: pointer;
}

.proof-item__check input[type="checkbox"] {
  width: 18px;
  height: 18px;
  min-width: 18px;
  border: 1.5px solid var(--color-border-strong);
  border-radius: var(--radius-sm);
  appearance: none;
  background-color: var(--color-surface);
  cursor: pointer;
  transition:
    background-color var(--transition-fast),
    border-color var(--transition-fast);
}

.proof-item__check input[type="checkbox"]:checked {
  background-color: var(--color-success);
  border-color: var(--color-success);
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 10 10'%3E%3Cpath fill='none' stroke='%23ffffff' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round' d='M2 5l2.5 2.5L8 3'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: center;
}

.proof-item__label-text {
  font-size: var(--text-sm);
  font-weight: var(--weight-medium);
  color: var(--color-text-primary);
  line-height: 1;
}

.proof-item__hint {
  font-size: var(--text-xs);
  color: var(--color-text-muted);
  line-height: var(--leading-normal);
  padding-left: calc(18px + var(--space-1));   /* REQ3: checkbox width(18) + gap(8) = 26 — expressed via tokens */
}

/* Checked state: item gets subtle success tint */
.proof-item:has(input:checked) {
  background-color: var(--color-success-bg);
}

.proof-item:has(input:checked) .proof-item__label-text {
  color: var(--color-success);
}


/* ═══════════════════════════════════════════════════════
   9. DIVIDER WITH LABEL
═══════════════════════════════════════════════════════ */

.divider-label {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin: var(--space-3) 0;
}

.divider-label::before,
.divider-label::after {
  content: '';
  flex: 1;
  height: 1px;
  background-color: var(--color-border);
}

.divider-label__text {
  font-size: var(--text-xs);
  font-weight: var(--weight-semibold);
  letter-spacing: var(--tracking-widest);
  text-transform: uppercase;
  color: var(--color-text-muted);
  white-space: nowrap;
  flex-shrink: 0;
}


/* ═══════════════════════════════════════════════════════
   10. INLINE ALERT / NOTIFICATION
   For contextual feedback inside the workspace.
   Not a toast — persistent inline message.
═══════════════════════════════════════════════════════ */

.alert {
  display: flex;
  align-items: flex-start;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  font-size: var(--text-sm);
  line-height: var(--leading-relaxed);
}

.alert__icon {
  flex-shrink: 0;
  font-size: 16px;
  line-height: 1.4;
}

.alert__content {
  flex: 1;
}

.alert__title {
  font-weight: var(--weight-semibold);
  margin-bottom: 2px;
}

.alert__body {
  color: inherit;
  opacity: 0.85;
}

.alert--info {
  background-color: var(--color-surface-subtle);
  border-color: var(--color-border);
  color: var(--color-text-secondary);
}

.alert--success {
  background-color: var(--color-success-bg);
  border-color: var(--color-success-border);
  color: var(--color-success);
}

.alert--warning {
  background-color: var(--color-warning-bg);
  border-color: var(--color-warning-border);
  color: var(--color-warning);
}

.alert--error {
  background-color: var(--color-error-bg);
  border-color: var(--color-error-border);
  color: var(--color-error);
}


/* ═══════════════════════════════════════════════════════
   11. TAG
   Small inline metadata label. Non-interactive.
═══════════════════════════════════════════════════════ */

.tag {
  display: inline-flex;
  align-items: center;
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  letter-spacing: var(--tracking-wide);
  color: var(--color-text-secondary);
  background-color: var(--color-surface-subtle);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-sm);
  padding: 2px var(--space-1);
  white-space: nowrap;
}

.tag--accent {
  background-color: var(--color-accent-subtle);
  border-color: var(--color-error-border);
  color: var(--color-accent);
}

.tag--success {
  background-color: var(--color-success-bg);
  border-color: var(--color-success-border);
  color: var(--color-success);
}


/* ═══════════════════════════════════════════════════════
   12. TOOLTIP (CSS-only hover tooltip)
═══════════════════════════════════════════════════════ */

[data-tooltip] {
  position: relative;
}

[data-tooltip]::after {
  content: attr(data-tooltip);
  position: absolute;
  bottom: calc(100% + 6px);
  left: 50%;
  transform: translateX(-50%);
  background-color: var(--color-text-primary);
  color: var(--color-text-inverse);
  font-family: var(--font-sans);
  font-size: var(--text-xs);
  font-weight: var(--weight-medium);
  white-space: nowrap;
  padding: var(--space-half) var(--space-1);
  border-radius: var(--radius-sm);
  pointer-events: none;
  opacity: 0;
  transition: opacity var(--transition-fast);
  z-index: var(--z-overlay);
}

[data-tooltip]:hover::after {
  opacity: 1;
}
